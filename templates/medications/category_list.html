{% extends 'base.html' %}
{% load static %}

{% block title %}Catégories - PharmaNPS-Alou{% endblock %}

{% block content %}
<div class="min-h-screen py-12 px-4 bg-gradient-to-br from-purple-50 via-white to-blue-50">
    <div class="max-w-7xl mx-auto">
        <!-- En-tête élégant -->
        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-12 gap-6 fade-in">
            <div class="space-y-4">
                <a href="{% url 'medication_list' %}" 
                   class="group inline-flex items-center text-blue-600 hover:text-blue-700 font-semibold transition-all duration-300 hover:translate-x-[-4px]">
                    <i class="fas fa-arrow-left mr-2 transition-transform group-hover:translate-x-[-4px]"></i>
                    Retour aux médicaments
                </a>
                
                <div class="flex items-center gap-4">
                    <div class="bg-gradient-to-br from-purple-500 via-purple-600 to-purple-700 p-5 rounded-2xl shadow-lg">
                        <i class="fas fa-tags text-white text-3xl"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl lg:text-5xl font-bold text-gray-900 mb-1">
                            Catégories
                        </h1>
                        <p class="text-gray-600 text-lg">Organisez vos médicaments par catégorie</p>
                    </div>
                </div>
            </div>
            
            <a href="{% url 'category_create' %}" 
               class="group relative bg-gradient-to-r from-purple-600 via-purple-700 to-purple-800 hover:from-purple-700 hover:via-purple-800 hover:to-purple-900 text-white px-8 py-4 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 shadow-xl hover:shadow-2xl shadow-purple-300/50 overflow-hidden">
                <span class="relative z-10 flex items-center">
                    <i class="fas fa-plus mr-3 group-hover:rotate-90 transition-transform duration-300"></i>
                    Nouvelle catégorie
                </span>
                <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-purple-600 opacity-0 group-hover:opacity-30 transition-opacity duration-300"></div>
            </a>
        </div>
        
        {% if categories %}
        <!-- Statistiques rapides -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 fade-in">
            <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white shadow-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-blue-100 text-sm font-semibold uppercase tracking-wide mb-1">Total Catégories</p>
                        <p class="text-4xl font-bold">{{ categories|length }}</p>
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm p-4 rounded-xl">
                        <i class="fas fa-tags text-3xl"></i>
                    </div>
                </div>
            </div>
            
            <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-6 text-white shadow-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-green-100 text-sm font-semibold uppercase tracking-wide mb-1">Médicaments Total</p>
                        <p class="text-4xl font-bold">
                            <!-- ATTENTION: Cette logique peut être lente si vous avez beaucoup de médicaments -->
                            {% with total_meds=0 %}
                            {% for cat in categories %}{% with total_meds=total_meds|add:cat.medications.count %}{% endwith %}{% endfor %}
                            {{ total_meds }}
                            {% endwith %}
                        </p>
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm p-4 rounded-xl">
                        <i class="fas fa-pills text-3xl"></i>
                    </div>
                </div>
            </div>
            
            <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 text-white shadow-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-purple-100 text-sm font-semibold uppercase tracking-wide mb-1">Organisation</p>
                        <p class="text-4xl font-bold">100%</p>
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm p-4 rounded-xl">
                        <i class="fas fa-chart-line text-3xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Grille des catégories -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for cat in categories %}
            <div class="group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 overflow-hidden border border-gray-100 fade-in-card" style="animation-delay: {{ forloop.counter0|add:1 }}00ms;">
                <!-- En-tête avec gradient -->
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 p-6 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"></div>
                    
                    <div class="relative flex items-center justify-between">
                        <div class="bg-white/20 backdrop-blur-sm rounded-2xl p-4 group-hover:scale-110 transition-transform duration-300">
                            <i class="fas fa-tag text-white text-3xl"></i>
                        </div>
                        <div class="bg-white text-purple-600 px-4 py-2 rounded-full font-bold shadow-lg">
                            <i class="fas fa-pills mr-1"></i>
                            {{ cat.medications.count }}
                        </div>
                    </div>
                </div>

                <!-- Contenu -->
                <div class="p-6">
                    <h3 class="text-2xl font-bold text-gray-900 mb-3 group-hover:text-purple-600 transition-colors duration-300">
                        {{ cat.name }}
                    </h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-6 min-h-[60px]">
                        {{ cat.description|default:"Aucune description disponible pour cette catégorie" }}
                    </p>
                    
                    <!-- Actions : Liens vers Modifier et Supprimer -->
                    <div class="flex gap-3">
                        
                       <!-- Dans category_list.html, remplacez les boutons par : -->

<div class="flex gap-2">
    <a href="{% url 'category_update' cat.pk %}" 
       class="flex-1 bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg font-semibold transition text-sm">
        <i class="fas fa-edit mr-1"></i>Modifier
    </a>
    <a href="{% url 'category_delete' cat.pk %}" 
       class="bg-red-100 hover:bg-red-200 text-red-700 px-4 py-2 rounded-lg font-semibold transition text-sm">
        <i class="fas fa-trash"></i>
    </a>
</div>
                    </div>
                </div>

                <!-- Barre décorative -->
                <div class="h-2 bg-gradient-to-r from-purple-400 via-purple-500 to-purple-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500 origin-left"></div>
            </div>
            {% endfor %}
        </div>
        
        {% else %}
        <!-- État vide stylisé -->
        <div class="bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-20 text-center border border-gray-100 fade-in">
            <div class="max-w-md mx-auto">
                <div class="bg-gradient-to-br from-purple-100 to-blue-100 rounded-full w-32 h-32 flex items-center justify-center mx-auto mb-8 animate-pulse-slow">
                    <i class="fas fa-tags text-purple-400 text-6xl"></i>
                </div>
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Aucune catégorie</h2>
                <p class="text-gray-600 text-lg mb-8 leading-relaxed">
                    Commencez par créer votre première catégorie pour organiser efficacement vos médicaments
                </p>
                <a href="{% url 'category_create' %}" 
                   class="group inline-flex items-center bg-gradient-to-r from-purple-600 via-purple-700 to-purple-800 hover:from-purple-700 hover:via-purple-800 hover:to-purple-900 text-white px-10 py-4 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 shadow-xl hover:shadow-2xl">
                    <i class="fas fa-plus mr-3 group-hover:rotate-90 transition-transform duration-300"></i>
                    Créer la première catégorie
                </a>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<style>
    /* Styles CSS pour les animations (à intégrer au besoin ou dans un fichier CSS externe) */
    .fade-in {
        animation: fadeInUp 0.6s ease-out;
    }
    
    .fade-in-card {
        animation: fadeInUp 0.6s ease-out backwards;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-pulse-slow {
        animation: pulse-slow 3s ease-in-out infinite;
    }

    @keyframes pulse-slow {
        0%, 100% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.05);
            opacity: 0.8;
        }
    }

    /* Effet de brillance au survol */
    .group:hover::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        animation: shine 0.8s;
    }

    @keyframes shine {
        to {
        }
    }
</style>
{% endblock %}
